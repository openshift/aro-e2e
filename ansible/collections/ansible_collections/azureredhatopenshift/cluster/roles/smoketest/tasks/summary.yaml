- name: summary | Summary
  block:
    - name: summary | Aggregate failure summary
      # Collect all namespaces where checks failed
      ansible.builtin.set_fact:
        smoketest_failures: "{{ smoketest_failures | d([]) }}"
    - name: summary | Final assertion
      # Fail the play if any namespace failed its health check
      ansible.builtin.assert:
        that:
          - smoketest_failures | length == 0
        fail_msg: "Smoke tests failed for: {{ smoketest_failures | join(', ') }}"
        success_msg: "All smoke tests passed successfully"
